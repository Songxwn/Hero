<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/hello-world/</url>
    <content><![CDATA[<h2 id="欢迎来到我的博客！"><a href="#欢迎来到我的博客！" class="headerlink" title="欢迎来到我的博客！"></a>欢迎来到我的博客！</h2><span id="more"></span>
<p>今天终于白嫖用 Github Pages,部署了一个自己的博客，打算发些自己写的技术文章。<br>使用Hexo+Next主题，然后套了CF的CDN。</p>
]]></content>
  </entry>
  <entry>
    <title>部署私有KMS服务器，并设置自动激活Windows和office</title>
    <url>/KMS/</url>
    <content><![CDATA[<p>#Docker镜像地址： <a href="https://hub.docker.com/r/mogeko/vlmcsd">https://hub.docker.com/r/mogeko/vlmcsd</a></p>
<p>#此程序的单独地址： <a href="https://github.com/Wind4/vlmcsd">https://github.com/Wind4/vlmcsd</a></p>
<h2 id="准备环境："><a href="#准备环境：" class="headerlink" title="准备环境："></a>准备环境：</h2><p>一台支持Docker的Linux服务器【运行KMS服务器】，运行在内网的DNS服务器【SRV记录】，DHCP服务器【分配DNS域名】。</p>
<span id="more"></span>


<p><code>docker run -d -p 1688:1688 --restart=always  --name kms mogeko/vlmcsd </code></p>
<p>// 部署KMS服务器，使用Docker ，端口为 TCP/1688。</p>
<p><code>docker logs vlmcsd</code></p>
<p>2021-07-27 08:14:00: Listening on [::]:1688<br>2021-07-27 08:14:00: Listening on 0.0.0.0:1688<br>2021-07-27 08:14:00: vlmcsd svn1112-2-gf1a3c7f, built 2021-07-26 18:11:51 UTC started successfully</p>
<p>查看日志，确定正常工作。</p>
<h2 id="手动激活"><a href="#手动激活" class="headerlink" title="手动激活"></a>手动激活</h2><p><code>slmgr /ipk N69G4-B89J2-4G8F4-WWYCC-J464C</code></p>
<p>//安装密钥</p>
<p>KMS安装密钥，密钥大全地址: <a href="https://docs.microsoft.com/zh-cn/windows-server/get-started/kmsclientkeys">https://docs.microsoft.com/zh-cn/windows-server/get-started/kmsclientkeys</a></p>
<p><code>slmgr /skms  192.168.1.13</code></p>
<p>//设置KMS服务器IP</p>
<p><code>slmgr /ato</code></p>
<p>//立即激活Windows</p>
<p><code>slmgr /xpr</code></p>
<p>//查看激活剩余时间</p>
<p><code>slmgr /dlv</code></p>
<p>//查看激活的详细信息</p>
<p>PS: 默认情况下，会激活 180天，然后每 10080 分钟自动续期一次（只要KMS服务器可用）</p>
<h2 id="使用DNS-DHCP自动激活"><a href="#使用DNS-DHCP自动激活" class="headerlink" title="使用DNS+DHCP自动激活"></a>使用DNS+DHCP自动激活</h2><p>首先添加 SRV 记录到DNS服务器的域名中</p>
<p>记录名字为 _vlmcs._tcp.</p>
<p>域控的话，直接有tcp的下级域，所以不需要加上TCP</p>
<p>然后进入你域控域名中的 _tcp文件夹，然后右键选择其他新记录，然后选择SRV记录。</p>
<p><img src="/images/pasted-2.png" alt="upload successful"></p>
<p>然后填写以上，域名为你的域名。服务为 _vlmcs 协议为 _tcp 。端口号为 1688 。<br>提供此服务的主机为   KMS服务器的IP。</p>
<p>然后配置DHCP 服务器分配的DNS域名后缀为 esc.com即可。<br>之后，未激活的Windows 开机就会通过DHCP获取到 DNS 后缀，然后通过DNS域名中的SVR记录找到<br>KMS激活服务器，并自动激活。其中VL的OFFICE也会自动激活。</p>
<h2 id="Office-VL版"><a href="#Office-VL版" class="headerlink" title="Office VL版"></a>Office VL版</h2><p>建议使用 Office Tool Plus 安装VL版本，并安装许可证。</p>
<p>下载地址： <a href="https://otp.landian.vip/zh-cn/download.html">https://otp.landian.vip/zh-cn/download.html</a></p>
]]></content>
      <categories>
        <category>KMS</category>
      </categories>
  </entry>
  <entry>
    <title>Windows 部署私有KMS服务器。</title>
    <url>/KMS-Windows/</url>
    <content><![CDATA[<p>程序下载地址：<a href="https://github.com/Wind4/vlmcsd">https://github.com/Wind4/vlmcsd</a></p>
<p>此文章介绍，怎么在Windows上运行vlmcsd，并注册为服务。</p>
<span id="more"></span>


<h2 id="下载解压程序"><a href="#下载解压程序" class="headerlink" title="下载解压程序"></a>下载解压程序</h2><p>去 <a href="https://github.com/Wind4/vlmcsd/releases">https://github.com/Wind4/vlmcsd/releases</a> 下载 binaries.tar.gz 文件。<br>下载到本地，解压。解压软件建议用 Bandizip <a href="https://www.bandisoft.com/bandizip">https://www.bandisoft.com/bandizip</a><br>将binaries/Windows/intel 文件夹重命名为vlmcsd，复制到C:\ 下面。</p>
<h2 id="注册为Windows-服务。"><a href="#注册为Windows-服务。" class="headerlink" title="注册为Windows 服务。"></a>注册为Windows 服务。</h2><p>以管理员身份运行CMD 或者 Power shell</p>
<p>输入 <code>cd C:\vkmcsd</code></p>
<p>// 切换到程序目录</p>
<p>输入 <code>./vlmcsd-Windows-x64.exe -s -l C:\vkmcsd\KMS.log</code></p>
<p>// -s 为安装为服务，-S 是删除服务，-l是指定输出日志文件路径；</p>
<p>##启动服务</p>
<p>输入 <code>Services.msc</code> 打开服务管理。</p>
<p>找到Key Management Server 服务器，启动服务，并确保启动类型为自动。</p>
<h2 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h2><p>将防火墙开放1688/tcp端口，或者直接关闭防火墙。</p>
<h2 id="验证服务是否正常运行"><a href="#验证服务是否正常运行" class="headerlink" title="验证服务是否正常运行"></a>验证服务是否正常运行</h2><p>输入 <code>./vlmcs-Windows-x64.exe</code></p>
<p>显示 successful 字样，则代表部署成功。</p>
]]></content>
      <categories>
        <category>KMS</category>
      </categories>
  </entry>
</search>
